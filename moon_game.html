<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Мини-игра: Луна</title>
    <style>
        /* Стили для игры */
        body {
            font-family: Arial, sans-serif;
            background-color: #2c3e50;
            color: #ecf0f1;
            text-align: center;
            padding: 20px;
            margin: 0;
        }

        .game-container {
            max-width: 800px;
            margin: 0 auto;
        }

        .wallet, .upgrade {
            margin: 20px 0;
        }

        .button {
            background-color: #2980b9;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .button:hover {
            background-color: #3498db;
        }

        .upgrade-info {
            margin-top: 10px;
        }

        .leaderboard {
            margin-top: 50px;
            font-size: 18px;
            text-align: left;
            background-color: #34495e;
            padding: 10px;
            border-radius: 5px;
            box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.2);
        }

        .moon-image {
            width: 200px;
            height: 200px;
            margin-top: 20px;
        }

        .timer {
            font-size: 18px;
            color: #f39c12;
            margin-top: 10px;
        }

        /* Боковой кошелек */
        .side-wallet {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: #34495e;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.3);
            color: white;
            font-size: 18px;
            z-index: 100;
        }

        .side-wallet button {
            background-color: #1abc9c;
            padding: 10px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            color: white;
        }

        .side-wallet button:hover {
            background-color: #16a085;
        }

    </style>
</head>
<body>

<div class="side-wallet">
    <p>Ваш кошелек: <span id="token-balance">0</span> $moon</p>
    <button class="button" id="claim-tokens-btn">Клеймить токены ($moon)</button>
</div>

<div class="game-container">
    <h1>Игра с Луной</h1>
    <img src="https://imgur.com/8jzFQ3K.jpg" alt="Луна" class="moon-image">
    
    <div class="wallet">
        <p>Ваш кошелек: <span id="token-balance-game">0</span> $moon</p>
        <p class="timer" id="timer"></p> <!-- Таймер для клейма -->
    </div>

    <div class="upgrade">
        <h2>Улучшение Луны</h2>
        <p>Стоимость улучшения: 100 $moon</p>
        <button class="button" id="buy-upgrade-btn">Купить улучшение</button>
        <div class="upgrade-info">
            <p>Текущее улучшение: <span id="moon-upgrade-level">0</span></p>
            <p>Эффективность: <span id="moon-effectiveness">1</span> токен/ч</p>
        </div>
    </div>

    <div class="leaderboard">
        <h3>Таблица лидеров</h3>
        <p>Игроки с максимальным количеством $moon:</p>
        <ul id="leaderboard-list">
            <!-- Таблица лидеров будет заполняться динамически -->
        </ul>
    </div>
</div>

<script>
    // Загрузка данных из localStorage или установка значений по умолчанию
    let playerWallet = JSON.parse(localStorage.getItem('playerWallet')) || {
        tokens: 0, // Токены $moon
        lastClaimTime: Date.now(), // Время последнего клейма токенов
        moonLevel: 0, // Уровень улучшения Луны
        moonEffectiveness: 1 // Эффективность улучшения
    };

    // Вспомогательная функция для обновления отображения баланса и улучшений
    function updateUI() {
        // Обновляем кошелек в игре
        document.getElementById('token-balance').innerText = playerWallet.tokens;
        document.getElementById('token-balance-game').innerText = playerWallet.tokens;

        // Обновляем уровень улучшения
        document.getElementById('moon-upgrade-level').innerText = playerWallet.moonLevel;
        document.getElementById('moon-effectiveness').innerText = playerWallet.moonEffectiveness;

        // Обновляем таблицу лидеров
        updateLeaderboard();

        // Обновляем таймер
        updateClaimTimer();
    }

    // Клеймить токены каждые 6 часов
    function claimTokens() {
        const now = Date.now();
        const timeDiff = now - playerWallet.lastClaimTime;

        // Проверяем, прошло ли 6 часов
        if (timeDiff >= 6 * 60 * 60 * 1000) {
            const tokensToClaim = playerWallet.moonEffectiveness * Math.floor(timeDiff / (6 * 60 * 60 * 1000));

            playerWallet.tokens += tokensToClaim;
            playerWallet.lastClaimTime = now;

            alert(`Вы получили ${tokensToClaim} $moon!`);

            // Сохраняем данные в localStorage
            localStorage.setItem('playerWallet', JSON.stringify(playerWallet));

            updateUI();
        } else {
            const remainingTime = 6 * 60 * 60 * 1000 - timeDiff;
            const hoursLeft = Math.ceil(remainingTime / (1000 * 60 * 60));
            alert(`Вы можете клеймить токены через ${hoursLeft} часов.`);
        }
    }

    // Покупка улучшения Луны
    function buyUpgrade() {
        if (playerWallet.tokens >= 100) {
            playerWallet.tokens -= 100;
            playerWallet.moonLevel++;
            playerWallet.moonEffectiveness = 1 + playerWallet.moonLevel; // Увеличиваем эффективность

            alert(`Вы купили улучшение Луны! Теперь эффективность: ${playerWallet.moonEffectiveness} токенов/ч.`);

            // Сохраняем данные в localStorage
            localStorage.setItem('playerWallet', JSON.stringify(playerWallet));

            updateUI();
        } else {
            alert("У вас недостаточно токенов для покупки улучшения.");
        }
    }

    // Обновление таблицы лидеров (сохранение данных локально)
    function updateLeaderboard() {
        // Для простоты, просто отображаем один игрока (вас)
        let leaderboardList = document.getElementById('leaderboard-list');
        leaderboardList.innerHTML = ''; // Очищаем таблицу

        let playerListItem = document.createElement('li');
        playerListItem.innerText = `Вы: ${playerWallet.tokens} $moon`;
        leaderboardList.appendChild(playerListItem);
    }

    // Обновление таймера для клейма
    function updateClaimTimer() {
        const now = Date.now();
        const timeDiff = now - playerWallet.lastClaimTime;
        const remainingTime = 6 * 60 * 60 * 1000 - timeDiff;

        if (remainingTime > 0) {
            const hoursLeft = Math.floor(remainingTime / (1000 * 60 * 60));
            const minutesLeft = Math.floor((remainingTime % (1000 * 60 * 60)) / (1000 * 60));
            const secondsLeft = Math.floor((remainingTime % (1000 * 60)) / 1000);

            document.getElementById('timer').innerText = `Следующее клеймение через: ${hoursLeft}ч ${minutesLeft}м ${secondsLeft}с`;
        } else {
            document.getElementById('timer').innerText = 'Можете клеймить токены!';
        }
    }

    // Привязка событий
    document.getElementById('claim-tokens-btn').addEventListener('click', claimTokens);
    document.getElementById('buy-upgrade-btn').addEventListener('click', buyUpgrade);

    // Инициализация
    updateUI();

    // Обновление таймера каждую секунду
    setInterval(updateClaimTimer, 1000);
</script>

</body>
</html>
